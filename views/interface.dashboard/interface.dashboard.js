init.interface.dashboard=function(args){$("#userID").html(args.userid);topmenuset("dashboard");clearInterval(intervals);manage_favourites=function(){var output="";output+='<table class="pure-table pure-table-striped"><tbody>';output+='<tr><td class="icon">'+svg["circle"]+'</td><td class="asset asset-btc">BTC</td><td class="full-name">Bitcoin</td>';output+='<td class="actions"><div class="assetbuttons assetbuttons-btc"><a onclick="" class="pure-button pure-button-grey button-unfavourite" role="button"><div class="actions-icon">'+svg["star-o"]+"</div>Remove star</a></div></td></tr>";output+='<tr><td class="icon">'+svg["circle"]+'</td><td class="asset asset-eth">ETH</td><td class="full-name">Ethereum</td>';output+='<td class="actions"><div class="assetbuttons assetbuttons-eth"><a onclick="" class="pure-button pure-button-warning button-favourite" role="button"><div class="actions-icon">'+svg["star"]+"</div>Add star</a></div></td></tr>";output+='<tr><td class="icon">'+svg["circle"]+'</td><td class="asset asset-lsk">LSK</td><td class="full-name">Lisk</td>';output+='<td class="actions"><div class="assetbuttons assetbuttons-lsk"><a onclick="" class="pure-button pure-button-warning button-favourite" role="button"><div class="actions-icon">'+svg["star"]+"</div>Add star</a></div></td></tr>";output+="</tbody></table>";$("#manage-favourites .data").html(output)};$(document).ready(function(){balance={};balance.asset=[];balance.amount=[];balance.lasttx=[];if(typeof GL.assetsActive==="undefined"){storage.Get(userStorageKey("ff00-0033"),function(crypted){GL.assetsActive=userDecode(crypted);if(typeof GL.assetsStarred==="undefined"){storage.Get(userStorageKey("ff00-0034"),function(crypted){GL.assetsStarred=userDecode(crypted);displayAssets()})}})}else{displayAssets()}})};function displayAssets(){if(GL.assetsActive==null||typeof GL.assetsActive!=="object"){GL.assetsActive=["btc","eth"]}if(GL.assetsStarred===null||typeof GL.assetsStarred!=="object"){var initAssetsStarred=GL.assetsActive.map(asset=>({id:asset,starred:false}));GL.assetsStarred=initAssetsStarred;storage.Set(userStorageKey("ff00-0034"),userEncode(initAssetsStarred))}var unmatchedStarredAssets=GL.assetsActive.filter(function(asset){return GL.assetsStarred.find(function(starred){return starred.id===asset})===undefined}).map(asset=>({id:asset,starred:false}));GL.assetsStarred.concat(unmatchedStarredAssets);$("#topmenu-assets").click(function(){fetchview("interface.assets",pass_args)});$("#topmenu-assets").addClass("active");hybriddcall({r:"/s/deterministic/hashes",z:1},null,function(object,passdata){assets.modehashes=object.data;var activeAssetsObj={};var i=0;for(i=0;i<GL.assetsActive.length;++i){if(typeof GL.assetmodes[GL.assetsActive[i]]!=="undefined"){activeAssetsObj[GL.assetsActive[i]]=GL.assetmodes[GL.assetsActive[i]]}}var output="";var i=0;for(var entry in activeAssetsObj){balance.asset[i]=entry;balance.amount[i]=0;i++;var defer=assets.init.indexOf(GL.assetmodes[entry].split(".")[0])==-1?0:3e3;assets.init.push(GL.assetmodes[entry].split(".")[0]);setTimeout(function(entry,passdata){initAsset(entry,GL.assetmodes[entry])},100*i+defer,entry);if(i===GL.assetsActive.length){var hasStarredAssets=GL.assetsStarred.reduce(function(b,asset){return asset.starred?asset.starred:b},false);var starredAssetsHTML=GL.assetsStarred.reduce(mkHtmlForStarredAssets,{i:0,str:""}).str;var noStarredAssetsHTML='<div class="no-starred-message">No starred assets found. Your favorite assets will be displayed here.</div>';function mkHtmlForStarredAssets(acc,asset){var index=acc.i;var str=asset.starred?acc.str+"<div onclick=\"fetchview('interface.assets',{user_keys: pass_args.user_keys, nonce: pass_args.nonce, asset:'"+asset.id+'\'});" class="balance"><h5>'+asset.id+'</h5><div class="divider"></div><h3 class="balance balance-'+asset.id.replace(/\./g,"-")+'">'+progressbar()+"</h3></div>":acc.str;return{i:acc.i+1,str:str}}$(".dashboard-balances .spinner-loader").fadeOut("slow",function(){$(".dashboard-balances > .data").html(hasStarredAssets?starredAssetsHTML:noStarredAssetsHTML)})}}var getBalances=function(balance,assets){var assetsToCheck=false?"assetsActive":"assetsStarred";GL[assetsToCheck].forEach(function(asset){var element=".dashboard-balances > .data > .balance > .balance-"+asset.id.replace(/\./g,"-");setTimeout(function(){hybriddcall({r:"a/"+asset.id+"/balance/"+assets.addr[asset.id],z:0},element,function(object){if(typeof object.data==="string"){object.data=UItransform.formatFloat(object.data)}return object})},i*500)})};intervals=setInterval(function(){getBalances(balance,assets)},6e4);loadinterval=setInterval(function(){var assetsloaded=true;for(i=0;i<5;i++){if(typeof balance.asset[i]!="undefined"&&typeof assets.addr[balance.asset[i]]=="undefined"){assetsloaded=false}}if(assetsloaded){getBalances(balance,assets);clearInterval(loadinterval)}},500)})}
