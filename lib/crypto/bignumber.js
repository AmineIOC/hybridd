var MAX=1e9,MAX_POWER=1e6,DECIMAL_PLACES=20,ROUNDING_MODE=4,TO_EXP_NEG=-7,TO_EXP_POS=21,MIN_EXP=-MAX,MAX_EXP=MAX,ERRORS=true,parse=parseInt,P=BigNumber.prototype,DIGITS="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ$_",outOfRange,id=0,isValid=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},ONE=BigNumber(1);function BigNumber(n,b){var e,i,isNum,digits,valid,orig,x=this;if(!(x instanceof BigNumber)){return new BigNumber(n,b)}if(n instanceof BigNumber){id=0;if(b!==e){n+=""}else{x["s"]=n["s"];x["e"]=n["e"];x["c"]=(n=n["c"])?n.slice():n;return}}if(typeof n!="string"){n=(isNum=typeof n=="number"||Object.prototype.toString.call(n)=="[object Number]")&&n===0&&1/n<0?"-0":n+""}orig=n;if(b===e&&isValid.test(n)){x["s"]=n.charAt(0)=="-"?(n=n.slice(1),-1):1}else{if(b==10){return setMode(n,DECIMAL_PLACES,ROUNDING_MODE)}n=trim.call(n).replace(/^\+(?!-)/,"");x["s"]=n.charAt(0)=="-"?(n=n.replace(/^-(?!-)/,""),-1):1;if(b!=null){if((b==(b|0)||!ERRORS)&&!(outOfRange=!(b>=2&&b<65))){digits="["+DIGITS.slice(0,b=b|0)+"]+";n=n.replace(/\.$/,"").replace(/^\./,"0.");if(valid=new RegExp("^"+digits+"(?:\\."+digits+")?$",b<37?"i":"").test(n)){if(isNum){if(n.replace(/^0\.0*|\./,"").length>15){ifExceptionsThrow(orig,0)}isNum=!isNum}n=convert(n,10,b,x["s"])}else if(n!="Infinity"&&n!="NaN"){ifExceptionsThrow(orig,1,b);n="NaN"}}else{ifExceptionsThrow(b,2);valid=isValid.test(n)}}else{valid=isValid.test(n)}if(!valid){x["c"]=x["e"]=null;if(n!="Infinity"){if(n!="NaN"){ifExceptionsThrow(orig,3)}x["s"]=null}id=0;return}}if((e=n.indexOf("."))>-1){n=n.replace(".","")}if((i=n.search(/e/i))>0){if(e<0){e=i}e+=+n.slice(i+1);n=n.substring(0,i)}else if(e<0){e=n.length}for(i=0;n.charAt(i)=="0";i++){}b=n.length;if(isNum&&b>15&&n.slice(i).length>15){ifExceptionsThrow(orig,0)}id=0;if((e-=i+1)>MAX_EXP){x["c"]=x["e"]=null}else if(i==b||e<MIN_EXP){x["c"]=[x["e"]=0]}else{for(;n.charAt(--b)=="0";){}x["e"]=e;x["c"]=[];for(e=0;i<=b;x["c"][e++]=+n.charAt(i++)){}}}BigNumber["ROUND_UP"]=0;BigNumber["ROUND_DOWN"]=1;BigNumber["ROUND_CEIL"]=2;BigNumber["ROUND_FLOOR"]=3;BigNumber["ROUND_HALF_UP"]=4;BigNumber["ROUND_HALF_DOWN"]=5;BigNumber["ROUND_HALF_EVEN"]=6;BigNumber["ROUND_HALF_CEIL"]=7;BigNumber["ROUND_HALF_FLOOR"]=8;BigNumber["fromBuffer"]=function(buf,opts){if(!opts)opts={};var endian={1:"big","-1":"little"}[opts.endian]||opts.endian||"big";var size=opts.size==="auto"?Math.ceil(buf.length):opts.size||1;if(buf.length%size!==0){throw new RangeError("Buffer length ("+buf.length+")"+" must be a multiple of size ("+size+")")}var hex=[];for(var i=0;i<buf.length;i+=size){var chunk=[];for(var j=0;j<size;j++){chunk.push(buf[i+(endian==="big"?j:size-j-1)])}hex.push(chunk.map(function(c){return(c<16?"0":"")+c.toString(16)}).join(""))}return BigNumber(hex.join(""),16)};BigNumber["config"]=function(){var v,p,i=0,r={},a=arguments,o=a[0],c="config",inRange=function(n,lo,hi){return!((outOfRange=n<lo||n>hi)||parse(n)!=n&&n!==0)},has=o&&typeof o=="object"?function(){if(o.hasOwnProperty(p))return(v=o[p])!=null}:function(){if(a.length>i)return(v=a[i++])!=null};if(has(p="DECIMAL_PLACES")){if(inRange(v,0,MAX)){DECIMAL_PLACES=v|0}else{ifExceptionsThrow(v,p,c)}}r[p]=DECIMAL_PLACES;if(has(p="ROUNDING_MODE")){if(inRange(v,0,8)){ROUNDING_MODE=v|0}else{ifExceptionsThrow(v,p,c)}}r[p]=ROUNDING_MODE;if(has(p="EXPONENTIAL_AT")){if(inRange(v,-MAX,MAX)){TO_EXP_NEG=-(TO_EXP_POS=~~(v<0?-v:+v))}else if(!outOfRange&&v&&inRange(v[0],-MAX,0)&&inRange(v[1],0,MAX)){TO_EXP_NEG=~~v[0];TO_EXP_POS=~~v[1]}else{ifExceptionsThrow(v,p,c,1)}}r[p]=[TO_EXP_NEG,TO_EXP_POS];if(has(p="RANGE")){if(inRange(v,-MAX,MAX)&&~~v){MIN_EXP=-(MAX_EXP=~~(v<0?-v:+v))}else if(!outOfRange&&v&&inRange(v[0],-MAX,-1)&&inRange(v[1],1,MAX)){MIN_EXP=~~v[0],MAX_EXP=~~v[1]}else{ifExceptionsThrow(v,p,c,1,1)}}r[p]=[MIN_EXP,MAX_EXP];if(has(p="ERRORS")){if(v===!!v||v===1||v===0){parse=(outOfRange=id=0,ERRORS=!!v)?parseInt:parseFloat}else{ifExceptionsThrow(v,p,c,0,0,1)}}r[p]=ERRORS;return r};function ifExceptionsThrow(arg,i,j,isArray,isRange,isErrors){if(ERRORS){var error,method=["new BigNumber","cmp","div","eq","gt","gte","lt","lte","minus","mod","plus","times","toFr"][id?id<0?-id:id:1/id<0?1:0]+"()",message=outOfRange?" out of range":" not a"+(isRange?" non-zero":"n")+" integer";message=([method+" number type has more than 15 significant digits",method+" not a base "+j+" number",method+" base"+message,method+" not a number"][i]||j+"() "+i+(isErrors?" not a boolean or binary digit":message+(isArray?" or not ["+(outOfRange?" negative, positive":" integer, integer")+" ]":"")))+": "+arg;outOfRange=id=0;error=new Error(message);error["name"]="BigNumber Error";throw error}}function convert(nStr,baseOut,baseIn,sign){var e,dvs,dvd,nArr,fracArr,fracBN;function strToArr(str,bIn){var j,i=0,strL=str.length,arrL,arr=[0];for(bIn=bIn||baseIn;i<strL;i++){for(arrL=arr.length,j=0;j<arrL;arr[j]*=bIn,j++){}for(arr[0]+=DIGITS.indexOf(str.charAt(i)),j=0;j<arr.length;j++){if(arr[j]>baseOut-1){if(arr[j+1]==null){arr[j+1]=0}arr[j+1]+=arr[j]/baseOut^0;arr[j]%=baseOut}}}return arr.reverse()}function arrToStr(arr){var i=0,arrL=arr.length,str="";for(;i<arrL;str+=DIGITS.charAt(arr[i++])){}return str}if(baseIn<37){nStr=nStr.toLowerCase()}if((e=nStr.indexOf("."))>-1){e=nStr.length-e-1;dvs=strToArr(new BigNumber(baseIn)["pow"](e)["toF"](),10);nArr=nStr.split(".");dvd=strToArr(nArr[1]);nArr=strToArr(nArr[0]);fracBN=divide(dvd,dvs,dvd.length-dvs.length,sign,baseOut,nArr[nArr.length-1]&1);fracArr=fracBN["c"];if(e=fracBN["e"]){for(;++e;fracArr.unshift(0)){}nStr=arrToStr(nArr)+"."+arrToStr(fracArr)}else if(fracArr[0]){if(nArr[e=nArr.length-1]<baseOut-1){++nArr[e];nStr=arrToStr(nArr)}else{nStr=new BigNumber(arrToStr(nArr),baseOut)["plus"](ONE)["toS"](baseOut)}}else{nStr=arrToStr(nArr)}}else{nStr=arrToStr(strToArr(nStr))}return nStr}function divide(dvd,dvs,exp,s,base,isOdd){var dvsL,dvsT,next,cmp,remI,dvsZ=dvs.slice(),dvdI=dvsL=dvs.length,dvdL=dvd.length,rem=dvd.slice(0,dvsL),remL=rem.length,quo=new BigNumber(ONE),qc=quo["c"]=[],qi=0,dig=DECIMAL_PLACES+(quo["e"]=exp)+1;quo["s"]=s;s=dig<0?0:dig;for(;remL++<dvsL;rem.push(0)){}dvsZ.unshift(0);do{for(next=0;next<base;next++){if(dvsL!=(remL=rem.length)){cmp=dvsL>remL?1:-1}else{for(remI=-1,cmp=0;++remI<dvsL;){if(dvs[remI]!=rem[remI]){cmp=dvs[remI]>rem[remI]?1:-1;break}}}if(cmp<0){for(dvsT=remL==dvsL?dvs:dvsZ;remL;){if(rem[--remL]<dvsT[remL]){for(remI=remL;remI&&!rem[--remI];rem[remI]=base-1){}--rem[remI];rem[remL]+=base}rem[remL]-=dvsT[remL]}for(;!rem[0];rem.shift()){}}else{break}}qc[qi++]=cmp?next:++next;rem[0]&&cmp?rem[remL]=dvd[dvdI]||0:rem=[dvd[dvdI]]}while((dvdI++<dvdL||rem[0]!=null)&&s--);if(!qc[0]&&qi!=1){--quo["e"];qc.shift()}if(qi>dig){rnd(quo,DECIMAL_PLACES,base,isOdd,rem[0]!=null)}if(quo["e"]>MAX_EXP){quo["c"]=quo["e"]=null}else if(quo["e"]<MIN_EXP){quo["c"]=[quo["e"]=0]}return quo}function format(n,d,exp){var i=d-(n=new BigNumber(n))["e"],c=n["c"];if(!c){return n["toS"]()}if(c.length>++d){rnd(n,i,10)}i=c[0]==0?i+1:exp?d:n["e"]+i+1;for(;c.length<i;c.push(0)){}i=n["e"];return exp==1||exp==2&&(--d<i||i<=TO_EXP_NEG)?(n["s"]<0&&c[0]?"-":"")+(c.length>1?(c.splice(1,0,"."),c.join("")):c[0])+(i<0?"e":"e+")+i:n["toS"]()}function rnd(x,dp,base,isOdd,r){var xc=x["c"],isNeg=x["s"]<0,half=base/2,i=x["e"]+dp+1,next=xc[i],more=r||i<0||xc[i+1]!=null;r=ROUNDING_MODE<4?(next!=null||more)&&(ROUNDING_MODE==0||ROUNDING_MODE==2&&!isNeg||ROUNDING_MODE==3&&isNeg):next>half||next==half&&(ROUNDING_MODE==4||more||ROUNDING_MODE==6&&(xc[i-1]&1||!dp&&isOdd)||ROUNDING_MODE==7&&!isNeg||ROUNDING_MODE==8&&isNeg);if(i<1||!xc[0]){xc.length=0;xc.push(0);if(r){xc[0]=1;x["e"]=-dp}else{x["e"]=0}return x}xc.length=i--;if(r){for(--base;++xc[i]>base;){xc[i]=0;if(!i--){++x["e"];xc.unshift(1)}}}for(i=xc.length;!xc[--i];xc.pop()){}return x}function setMode(x,dp,rm){var r=ROUNDING_MODE;ROUNDING_MODE=rm;x=new BigNumber(x);x["c"]&&rnd(x,dp,10);ROUNDING_MODE=r;return x}P["abs"]=P["absoluteValue"]=function(){var x=new BigNumber(this);if(x["s"]<0){x["s"]=1}return x};P["bitLength"]=function(){return this.toString(2).length};P["ceil"]=function(){return setMode(this,0,2)};P["comparedTo"]=P["cmp"]=function(y,b){var a,x=this,xc=x["c"],yc=(id=-id,y=new BigNumber(y,b))["c"],i=x["s"],j=y["s"],k=x["e"],l=y["e"];if(!i||!j){return null}a=xc&&!xc[0],b=yc&&!yc[0];if(a||b){return a?b?0:-j:i}if(i!=j){return i}if(a=i<0,b=k==l,!xc||!yc){return b?0:!xc^a?1:-1}if(!b){return k>l^a?1:-1}for(i=-1,j=(k=xc.length)<(l=yc.length)?k:l;++i<j;){if(xc[i]!=yc[i]){return xc[i]>yc[i]^a?1:-1}}return k==l?0:k>l^a?1:-1};P["dividedBy"]=P["div"]=function(y,b){var xc=this["c"],xe=this["e"],xs=this["s"],yc=(id=2,y=new BigNumber(y,b))["c"],ye=y["e"],ys=y["s"],s=xs==ys?1:-1;return!xe&&(!xc||!xc[0])||!ye&&(!yc||!yc[0])?new BigNumber(!xs||!ys||(xc?yc&&xc[0]==yc[0]:!yc)?NaN:xc&&xc[0]==0||!yc?s*0:s/0):divide(xc,yc,xe-ye,s,10)};P["equals"]=P["eq"]=function(n,b){id=3;return this["cmp"](n,b)===0};P["floor"]=function(){return setMode(this,0,3)};P["greaterThan"]=P["gt"]=function(n,b){id=4;return this["cmp"](n,b)>0};P["greaterThanOrEqualTo"]=P["gte"]=P["gt"]=function(n,b){id=5;return(b=this["cmp"](n,b))==1||b===0};P["isFinite"]=P["isF"]=function(){return!!this["c"]};P["isNaN"]=function(){return!this["s"]};P["isNegative"]=P["isNeg"]=function(){return this["s"]<0};P["isZero"]=P["isZ"]=function(){return!!this["c"]&&this["c"][0]==0};P["lessThan"]=P["lt"]=function(n,b){id=6;return this["cmp"](n,b)<0};P["lessThanOrEqualTo"]=P["lte"]=P["le"]=function(n,b){id=7;return(b=this["cmp"](n,b))==-1||b===0};P["minus"]=P["sub"]=function(y,b){var d,i,j,xLTy,x=this,a=x["s"];b=(id=8,y=new BigNumber(y,b))["s"];if(!a||!b){return new BigNumber(NaN)}if(a!=b){return y["s"]=-b,x["plus"](y)}var xc=x["c"],xe=x["e"],yc=y["c"],ye=y["e"];if(!xe||!ye){if(!xc||!yc){return xc?(y["s"]=-b,y):new BigNumber(yc?x:NaN)}if(!xc[0]||!yc[0]){return yc[0]?(y["s"]=-b,y):new BigNumber(xc[0]?x:ROUNDING_MODE==3?-0:0)}}if(xc=xc.slice(),a=xe-ye){d=(xLTy=a<0)?(a=-a,xc):(ye=xe,yc);for(d.reverse(),b=a;b--;d.push(0)){}d.reverse()}else{j=((xLTy=xc.length<yc.length)?xc:yc).length;for(a=b=0;b<j;b++){if(xc[b]!=yc[b]){xLTy=xc[b]<yc[b];break}}}if(xLTy){d=xc,xc=yc,yc=d;y["s"]=-y["s"]}if((b=-((j=xc.length)-yc.length))>0){for(;b--;xc[j++]=0){}}for(b=yc.length;b>a;){if(xc[--b]<yc[b]){for(i=b;i&&!xc[--i];xc[i]=9){}--xc[i];xc[b]+=10}xc[b]-=yc[b]}for(;xc[--j]==0;xc.pop()){}for(;xc[0]==0;xc.shift(),--ye){}if(ye<MIN_EXP||!xc[0]){if(!xc[0]){y["s"]=ROUNDING_MODE==3?-1:1}xc=[ye=0]}return y["c"]=xc,y["e"]=ye,y};P["modulo"]=P["mod"]=function(y,b){var x=this,xc=x["c"],yc=(id=9,y=new BigNumber(y,b))["c"],i=x["s"],j=y["s"];b=!i||!j||yc&&!yc[0];if(b||xc&&!xc[0]){return new BigNumber(b?NaN:x)}x["s"]=y["s"]=1;b=y["cmp"](x)==1;x["s"]=i,y["s"]=j;return b?new BigNumber(x):(i=DECIMAL_PLACES,j=ROUNDING_MODE,DECIMAL_PLACES=0,ROUNDING_MODE=1,x=x["div"](y),DECIMAL_PLACES=i,ROUNDING_MODE=j,this["minus"](x["times"](y)))};P["negated"]=P["neg"]=function(){var x=new BigNumber(this);return x["s"]=-x["s"]||null,x};P["plus"]=P["add"]=function(y,b){var d,x=this,a=x["s"];b=(id=10,y=new BigNumber(y,b))["s"];if(!a||!b){return new BigNumber(NaN)}if(a!=b){return y["s"]=-b,x["minus"](y)}var xe=x["e"],xc=x["c"],ye=y["e"],yc=y["c"];if(!xe||!ye){if(!xc||!yc){return new BigNumber(a/0)}if(!xc[0]||!yc[0]){return yc[0]?y:new BigNumber(xc[0]?x:a*0)}}if(xc=xc.slice(),a=xe-ye){d=a>0?(ye=xe,yc):(a=-a,xc);for(d.reverse();a--;d.push(0)){}d.reverse()}if(xc.length-yc.length<0){d=yc,yc=xc,xc=d}for(a=yc.length,b=0;a;b=(xc[--a]=xc[a]+yc[a]+b)/10^0,xc[a]%=10){}if(b){xc.unshift(b);if(++ye>MAX_EXP){xc=ye=null}}for(a=xc.length;xc[--a]==0;xc.pop()){}return y["c"]=xc,y["e"]=ye,y};P["toPower"]=P["pow"]=function(e){var i=e*0==0?e|0:e,x=new BigNumber(this),y=new BigNumber(ONE);if(((outOfRange=e<-MAX_POWER||e>MAX_POWER)&&(i=e*1/0)||parse(e)!=e&&e!==0&&!(i=NaN))&&!ifExceptionsThrow(e,"exponent","pow")||!i){return new BigNumber(Math.pow(x["toS"](),i))}for(i=i<0?-i:i;;){if(i&1){y=y["times"](x)}i>>=1;if(!i){break}x=x["times"](x)}return e<0?ONE["div"](y):y};P["powm"]=function(m,n){return this.pow(m).mod(n)};P["round"]=function(dp,rm){dp=dp==null||((outOfRange=dp<0||dp>MAX)||parse(dp)!=dp)&&!ifExceptionsThrow(dp,"decimal places","round")?0:dp|0;rm=rm==null||((outOfRange=rm<0||rm>8)||parse(rm)!=rm&&rm!==0)&&!ifExceptionsThrow(rm,"mode","round")?ROUNDING_MODE:rm|0;return setMode(this,dp,rm)};P["squareRoot"]=P["sqrt"]=function(){var n,r,re,t,x=this,c=x["c"],s=x["s"],e=x["e"],dp=DECIMAL_PLACES,rm=ROUNDING_MODE,half=new BigNumber("0.5");if(s!==1||!c||!c[0]){return new BigNumber(!s||s<0&&(!c||c[0])?NaN:c?x:1/0)}s=Math.sqrt(x["toS"]());ROUNDING_MODE=1;if(s==0||s==1/0){n=c.join("");if(!(n.length+e&1)){n+="0"}r=new BigNumber(Math.sqrt(n)+"");if(!r["c"]){r["c"]=[1]}r["e"]=((e+1)/2|0)-(e<0||e&1)}else{r=new BigNumber(n=s.toString())}re=r["e"];s=re+(DECIMAL_PLACES+=4);if(s<3){s=0}e=s;for(;;){t=r;r=half["times"](t["plus"](x["div"](t)));if(t["c"].slice(0,s).join("")===r["c"].slice(0,s).join("")){c=r["c"];s=s-(n&&r["e"]<re);if(c[s]==9&&c[s-1]==9&&c[s-2]==9&&(c[s-3]==9||n&&c[s-3]==4)){if(n&&c[s-3]==9){t=r["round"](dp,0);if(t["times"](t)["eq"](x)){ROUNDING_MODE=rm;DECIMAL_PLACES=dp;return t}}DECIMAL_PLACES+=4;s+=4;n=""}else{if(!c[e]&&!c[e-1]&&!c[e-2]&&(!c[e-3]||c[e-3]==5)){if(c.length>e-2){c.length=e-2}if(!r["times"](r)["eq"](x)){while(c.length<e-3){c.push(0)}c[e-3]++}}ROUNDING_MODE=rm;rnd(r,DECIMAL_PLACES=dp,10);return r}}}};P["times"]=P["mul"]=function(y,b){var c,x=this,xc=x["c"],yc=(id=11,y=new BigNumber(y,b))["c"],i=x["e"],j=y["e"],a=x["s"];y["s"]=a==(b=y["s"])?1:-1;if(!i&&(!xc||!xc[0])||!j&&(!yc||!yc[0])){return new BigNumber(!a||!b||xc&&!xc[0]&&!yc||yc&&!yc[0]&&!xc?NaN:!xc||!yc?y["s"]/0:y["s"]*0)}y["e"]=i+j;if((a=xc.length)<(b=yc.length)){c=xc,xc=yc,yc=c,j=a,a=b,b=j}for(j=a+b,c=[];j--;c.push(0)){}for(i=b-1;i>-1;i--){for(b=0,j=a+i;j>i;b=c[j]+yc[i]*xc[j-i-1]+b,c[j--]=b%10|0,b=b/10|0){}if(b){c[j]=(c[j]+b)%10}}b&&++y["e"];!c[0]&&c.shift();for(j=c.length;!c[--j];c.pop()){}y["c"]=y["e"]>MAX_EXP?y["e"]=null:y["e"]<MIN_EXP?[y["e"]=0]:c;return y};P["toBuffer"]=function(opts){if(typeof opts==="string"){if(opts!=="mpint")return"Unsupported Buffer representation";var abs=this.abs();var buf=abs.toBuffer({size:1,endian:"big"});var len=buf.length===1&&buf[0]===0?0:buf.length;if(buf[0]&128)len++;var ret=new Buffer(4+len);if(len>0)buf.copy(ret,4+(buf[0]&128?1:0));if(buf[0]&128)ret[4]=0;ret[0]=len&255<<24;ret[1]=len&255<<16;ret[2]=len&255<<8;ret[3]=len&255<<0;var isNeg=this.lt(0);if(isNeg){for(var i=4;i<ret.length;i++){ret[i]=255-ret[i]}}ret[4]=ret[4]&127|(isNeg?128:0);if(isNeg)ret[ret.length-1]++;return ret}if(!opts)opts={};var endian={1:"big","-1":"little"}[opts.endian]||opts.endian||"big";var hex=this.toString(16);if(hex.charAt(0)==="-")throw new Error("converting negative numbers to Buffers not supported yet");var size=opts.size==="auto"?Math.ceil(hex.length/2):opts.size||1;var len=Math.ceil(hex.length/(2*size))*size;var buf=new Buffer(len);while(hex.length<2*len)hex="0"+hex;var hx=hex.split(new RegExp("(.{"+2*size+"})")).filter(function(s){return s.length>0});hx.forEach(function(chunk,i){for(var j=0;j<size;j++){var ix=i*size+(endian==="big"?j:size-j-1);buf[ix]=parseInt(chunk.slice(j*2,j*2+2),16)}});return buf};P["toExponential"]=P["toE"]=function(dp){return format(this,(dp==null||((outOfRange=dp<0||dp>MAX)||parse(dp)!=dp&&dp!==0)&&!ifExceptionsThrow(dp,"decimal places","toE"))&&this["c"]?this["c"].length-1:dp|0,1)};P["toFixed"]=P["toF"]=function(dp){var n,str,d,x=this;if(!(dp==null||((outOfRange=dp<0||dp>MAX)||parse(dp)!=dp&&dp!==0)&&!ifExceptionsThrow(dp,"decimal places","toF"))){d=x["e"]+(dp|0)}n=TO_EXP_NEG,dp=TO_EXP_POS;TO_EXP_NEG=-(TO_EXP_POS=1/0);if(d==str){str=x["toS"]()}else{str=format(x,d);if(x["s"]<0&&x["c"]){if(!x["c"][0]){str=str.replace(/^-/,"")}else if(str.indexOf("-")<0){str="-"+str}}}TO_EXP_NEG=n,TO_EXP_POS=dp;return str};P["toFraction"]=P["toFr"]=function(maxD){var q,frac,n0,d0,d2,n,e,n1=d0=new BigNumber(ONE),d1=n0=new BigNumber("0"),x=this,xc=x["c"],exp=MAX_EXP,dp=DECIMAL_PLACES,rm=ROUNDING_MODE,d=new BigNumber(ONE);if(!xc){return x["toS"]()}e=d["e"]=xc.length-x["e"]-1;if(maxD==null||(!(id=12,n=new BigNumber(maxD))["s"]||(outOfRange=n["cmp"](n1)<0||!n["c"])||ERRORS&&n["e"]<n["c"].length-1)&&!ifExceptionsThrow(maxD,"max denominator","toFr")||(maxD=n)["cmp"](d)>0){maxD=e>0?d:n1}MAX_EXP=1/0;n=new BigNumber(xc.join(""));for(DECIMAL_PLACES=0,ROUNDING_MODE=1;;){q=n["div"](d);d2=d0["plus"](q["times"](d1));if(d2["cmp"](maxD)==1){break}d0=d1,d1=d2;n1=n0["plus"](q["times"](d2=n1));n0=d2;d=n["minus"](q["times"](d2=d));n=d2}d2=maxD["minus"](d0)["div"](d1);n0=n0["plus"](d2["times"](n1));d0=d0["plus"](d2["times"](d1));n0["s"]=n1["s"]=x["s"];DECIMAL_PLACES=e*2;ROUNDING_MODE=rm;frac=n1["div"](d1)["minus"](x)["abs"]()["cmp"](n0["div"](d0)["minus"](x)["abs"]())<1?[n1["toS"](),d1["toS"]()]:[n0["toS"](),d0["toS"]()];return MAX_EXP=exp,DECIMAL_PLACES=dp,frac};P["toPrecision"]=P["toP"]=function(sd){return sd==null||((outOfRange=sd<1||sd>MAX)||parse(sd)!=sd)&&!ifExceptionsThrow(sd,"precision","toP")?this["toS"]():format(this,--sd|0,2)};P["toString"]=P["toS"]=function(b){var u,str,strL,x=this,xe=x["e"];if(xe===null){str=x["s"]?"Infinity":"NaN"}else if(b===u&&(xe<=TO_EXP_NEG||xe>=TO_EXP_POS)){return format(x,x["c"].length-1,1)}else{str=x["c"].join("");if(xe<0){for(;++xe;str="0"+str){}str="0."+str}else if(strL=str.length,xe>0){if(++xe>strL){for(xe-=strL;xe--;str+="0"){}}else if(xe<strL){str=str.slice(0,xe)+"."+str.slice(xe)}}else{if(u=str.charAt(0),strL>1){str=u+"."+str.slice(1)}else if(u=="0"){return u}}if(b!=null){if(!(outOfRange=!(b>=2&&b<65))&&(b==(b|0)||!ERRORS)){str=convert(str,b|0,10,x["s"]);if(str=="0"){return str}}else{ifExceptionsThrow(b,"base","toS")}}}return x["s"]<0?"-"+str:str};P["valueOf"]=function(){return this["toS"]()};if(typeof module!="undefined"){module.exports=BigNumber}
